var formulaAssistance=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[18],{2e3:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(o||(t.DefinedNameInfoType=o={}))},2001:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(o||(t.MajorityDataType=o={}))},2002:function(e,t,n){"use strict";var o,a,r,i,l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(o||(t.CompletionItemKind=o={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(a||(t.SuggestionKind=a={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(r||(t.DiagnosticSeverity=r={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(l||(t.CodeActionKind=l={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(c||(t.RepairItemPartType=c={}))},2003:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2004:function(e,t,n){"use strict";var o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(o||(t.IncompatibilityType=o={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(a||(t.ReferenceMode=a={}))},2005:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2006:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2007:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(o||(t.Rounding=o={}))},2008:function(e,t,n){"use strict";var o,a,r,i,l,c,s,u,d,m,p,g,f,b;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(o||(t.EditorMessageType=o={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(a||(t.MessageType=a={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(r||(t.PluginFactoryName=r={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(i||(t.PluginGroup=i={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(l||(t.PluginAttachGroup=l={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(c||(t.PerCharacterExperimentResultKind=c={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(s||(t.HighlightKind=s={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(u||(t.PositionKind=u={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(d||(t.ValuePreviewResultKind=d={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure"}(m||(t.GotoCtrlClickResultKind=m={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(p||(t.SchedulerFeature=p={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(g||(t.ColumnFormulaSuggestionUpdateKind=g={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(f||(t.RecognizedTablesMetadataState=f={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(b||(t.TableOrientation=b={}))},2009:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2010:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(3).__exportStar(n(2012),t)},2012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2029:function(e,t,n){"use strict";n.r(t),n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return Dn}));var o=n(3),a=n(1),r=n(374),i=n(60),l=n(16),c="aa-callout",s="aa-header",u=n(1347),d=n(26),m=n.n(d),p=n(5),g=n(150),f=n(17),b=n(99),h=Object(o.__assign)(Object(o.__assign)({},p.b.fadeIn100),{animationTimingFunction:p.c.easeFunction1}),v="0.467s cubic-bezier(0.5, 0, 0, 1)",x=300,E=415,C=500,y={animation:"none","will-change":"transform",left:"0px !important /* @noflip */",right:"auto !important /* @noflip */",top:"var(--top) !important",bottom:"var(--bottom) !important",maxWidth:"var(--max-width) !important",maxHeight:"var(--max-height) !important"},S={root:Object(o.__assign)({borderRadius:4},h),calloutMain:{borderRadius:4}},_={root:{color:Object(b.a)().primary,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,userSelect:"none",selectors:{"&:active, &:hover, &:active:hover, &:focus":{color:Object(b.a)().primary}}}},P={scrollbarWidth:"thin",scrollbarColor:"#808080 #FFF","-ms-scrollbar-base-color":"#808080","-ms-scrollbar-track-color":"#FFF",selectors:{"::-webkit-scrollbar":{width:14},"::-webkit-scrollbar-thumb":{borderRadius:20,backgroundColor:g.a.gray110,border:"solid 4px transparent",backgroundClip:"content-box"},"::-webkit-scrollbar-thumb:hover":{backgroundColor:g.a.gray120},"::-webkit-scrollbar-button:vertical":{height:4}}},R={container:{height:"100%"},root:{height:"100%",maxWidth:"max-content",boxSizing:"border-box"}},O=5,k=7,A=20,w=20,F=340,j={padding:"".concat(O,"px ").concat(k,"px")},T=n(22),I=Object(T.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistantMinifiedState",!1),M=Object(l.c)((function(e){var t=e===Y.expanded,n=t||e===Y.collapsed,a=function(){return I?n?"".concat(2*O,"px ").concat(2*k,"px"):void 0:"".concat(O,"px ").concat(k,"px")};return Object(p.db)({cardPart:{padding:a()},expandedCardPart:{padding:a(),minWidth:t?void 0:"".concat(F-2*k,"px")},focusTrapCallout:{height:"100%"},root:{display:"flex",width:n?"min-content":"".concat(w,"px"),maxHeight:n?"100%":void 0,cursor:"default",flexDirection:"column"},collapsedCard:{width:"max-content",maxWidth:"".concat(C,"px"),minWidth:I||t?"".concat(F,"px"):"0px",direction:"ltr",flexShrink:0,transition:t?void 0:"min-width ".concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s"),selectors:{":after":D(t)}},expandedCard:Object(o.__assign)(Object(o.__assign)({overflowY:"auto",maxWidth:t?"".concat(C,"px"):"0px",transition:I?n?"max-height ".concat(v):void 0:t?"max-height ".concat(v):"max-height ".concat(v,", max-width ").concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s")},P),{":before":D(!t)}),collapseHeader:{width:"85%"}})})),N=Object(p.db)(S,{calloutMain:{overflow:"hidden"}}),D=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(k,"px 0px ").concat(k,"px"),height:1,backgroundColor:g.a.gray40}},B=Object(l.c)((function(){var e;return{root:{height:A,width:w,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(o.__assign)({},f.o),e)},icon:{height:16,width:16}}})),H=Object(l.c)((function(){return Object(p.db)(B(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),W=Object(l.c)((function(){return Object(p.db)(B(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),L=Object(l.c)((function(){var e;return Object(p.db)(B(),{icon:{height:22,width:20,transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")"),backgroundColor:"green",selectors:(e={},e["path.OfficeIconColors_m22"]={fill:"white"},e["path.OfficeIconColors_m20"]={fill:"green"},e),root:{height:22,width:20,top:0,borderRadius:2},flexContainer:{marginLeft:1}}})})),z=n(2522),G=n(75),K=n(74),V=n(181);function U(e){var t=Object(a.useRef)(0),n=Object(a.useState)(null),o=n[0],r=n[1];return Object(a.useEffect)((function(){var n=-1,o=function(){var a=document.getElementById(e);a?(r(a),t.current>=10&&G.a.sendTraceTag(508842627,K.a.msoulscat_ES_EWAJS,V.a.Warning,"useElementById found #".concat(e," ")+"in ".concat(t.current," frames."))):t.current<40?(t.current++,n=requestAnimationFrame(o)):G.a.sendTraceTag(509634701,K.a.msoulscat_ES_EWAJS,V.a.Error,"useElementById couldn't find #".concat(e," ")+"in less than ".concat(t.current," frames."))};return o(),function(){return cancelAnimationFrame(n)}}),[e,40]),o}function J(e,t,n){return e<t?t:e>n?n:e}function Z(e){var t=e.x,n=e.y,o=e.maxWidth,a=e.maxHeight,r=e.renderDown,i=r?"0px":"auto",l=r?"auto":"-100vh",c=r?"".concat(Math.round(n),"px"):"calc(".concat(Math.round(n),"px - 100vh)");return{transform:"translate(".concat(Math.round(t),"px, ").concat(c,")"),"--top":i,"--bottom":l,"--max-width":"".concat(o,"px"),"--max-height":"".concat(a,"px")}}function Q(e,t,n,o,a,r,i){var l={top:8,left:8,right:window.innerWidth-8,bottom:window.innerHeight-8},c={top:J(i.top,l.top,l.bottom),left:J(i.left,l.left,l.right),right:J(i.right,l.left,l.right),bottom:J(i.bottom,l.top,l.bottom)},s={top:J(e.top,c.top,c.bottom),left:J(e.left,c.left,c.right),right:J(e.right,c.left,c.right),bottom:J(e.bottom,c.top,c.bottom)},u=c.right-c.left,d=function(e,t,n,o,a,r){if(o){var i=r.bottom-t,l=e-r.top,c=(a?i:l)>=n,s=c?a:!a,u=r.bottom-r.top;return!c&&n>i&&n>l&&(s=i>=l),{availableVerticalSpace:u,shouldRenderDown:s}}var d=e-r.top,m=r.bottom-t,p=n<=d,g=n<=m,f=0,b=a;a&&g?f=m:!a&&p?f=d:(b=m>=d,f=Math.max(m,d));return{availableVerticalSpace:f,shouldRenderDown:b}}(s.top,s.bottom,n,a,r,c),m=d.availableVerticalSpace,p=d.shouldRenderDown,g=Math.min(E,m),f=Math.min(C,u),b=J(s.left,c.left,c.right-Math.min(o,f)),h=0;if(a&&r!==p){var v=s.top;h=p?v-t:v+t}else h=p?s.bottom:s.top;var x=h;return a&&(x=J(h,p?c.top:Math.min(c.bottom,c.top+t),p?Math.max(c.top,c.bottom-t):c.bottom)),{x:b,y:x,maxWidth:f,maxHeight:g,renderDown:p}}var Y,X=n(14),q=n.n(X);!function(e){e[e.expanded=0]="expanded",e[e.collapsed=1]="collapsed",e[e.singleLine=2]="singleLine"}(Y||(Y={}));var $,ee,te,ne=Object(T.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistantMinifiedState",!1),oe=a.forwardRef((function(e,t){var n=e.hidden,l=e.setComponentApi,s=e.onLayoutChange,d=e.getTargetAndBounds,p=e.renderCompactCard,g=e.renderExpandedCard,f=e.onIsExpandedChange,b=e.isExpanded,h=e.collapsedId,E=Object(o.__rest)(e,["hidden","setComponentApi","onLayoutChange","getTargetAndBounds","renderCompactCard","renderExpandedCard","onIsExpandedChange","isExpanded","collapsedId"]),C=U(c),y=a.useState(b?Y.expanded:Y.collapsed),S=y[0],_=y[1],P=a.useRef(null),R=a.useRef(null),O=a.useRef(null),k=a.useRef(null),A=a.useRef(null),w=a.useRef(S),j=a.useRef(-1),T=a.useRef(-1),I=a.useCallback((function(e){var t;if(void 0===e&&(e=!1),!n&&C){var o,a=P.current,r=O.current,i=A.current,l=S!==Y.singleLine?a.scrollHeight+r.scrollHeight:null==i?void 0:i.scrollHeight,c=S!==Y.singleLine?a.scrollWidth:0,u=d(),m=u.target,p=u.bounds,g=u.isFloating,f=u.renderDown,b=u.activeCellAndGridZoom;switch(S===Y.singleLine&&(m.left-=10*(null!==(t=null==b?void 0:b.zoomNumber)&&void 0!==t?t:1)),S){case Y.expanded:o=l;break;case Y.collapsed:o=a.clientHeight;break;default:o=0}var h=g?l:Math.max(l,x),E=!1;if(g)(j.current!==m.top||T.current!==m.left)&&((E=!f&&!e)&&(m.top-=o,m.bottom=m.top),j.current=m.top,T.current=m.left);var y=Q(m,o,h,c,g,f||E,p);s(y);var _=S!==w.current,R=y.renderDown===f&&y.y!==m.top,k=_&&R;w.current=S;var I=Z(y);if(k){C.style.transition="transform ".concat(v);var M=function(){C.style.transition="",C.ontransitionend=null,C.ontransitioncancel=null};C.ontransitionend=M,C.ontransitioncancel=M}for(var N=0,D=Object.entries(I);N<D.length;N++){var B=D[N],H=B[0],W=B[1];C.style.setProperty(H,W)}var L=y.maxWidth<F;C.style.minWidth=S===Y.expanded?"".concat(L?y.maxWidth:F,"px"):"0px";var z=S===Y.expanded&&y.maxHeight<l;r.style.overflow=z?"hidden auto":"hidden";var G=S===Y.expanded&&y.renderDown;ne||a.style.setProperty("--collapse-icon-transform",G?"scaleY(-1)":"")}}),[d,n,S,s,C]);a.useEffect((function(){if(C){var e=O.current,t=S===Y.expanded?e.scrollHeight:0;e.style.maxHeight="".concat(t,"px")}})),a.useEffect((function(){C&&I(!0)})),a.useEffect((function(){l({updatePosition:I})}),[l,I]);var D=M(S),B=function(){G.a.sendTraceTag(507327841,K.a.msoulscat_ES_EWAJS,V.a.Info,"Formula Argument Assistance Close Button Clicked")},J=function(e){S!==Y.singleLine?_(Y.singleLine):_(Y.collapsed),S!==Y.singleLine?null==f||f(S===Y.expanded):B()},X=function(e){e.preventDefault()},$=S===Y.expanded?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceCollapse):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand);return a.createElement(u.a,Object(o.__assign)({onKeyDownCapture:function(e){var t,n,o=null!==(t=e.keyCode)&&void 0!==t?t:e.which;S!==Y.expanded||o!==i.a.up&&o!==i.a.down||null===(n=O.current)||void 0===n||n.scrollBy({top:o===i.a.up?-100:100,left:0,behavior:"smooth"})},isBeakVisible:!1,styles:N,hidden:n,focusTrapProps:{className:D.focusTrapCallout,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},E),a.createElement("div",{ref:t,className:D.root},a.createElement("div",{id:h,className:D.collapsedCard,ref:P},a.createElement(r.a,{className:D.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},S!==Y.singleLine&&a.createElement(a.Fragment,null,a.createElement(a.Fragment,null,ne&&a.createElement(a.Fragment,null,a.createElement(z.a,{id:"toggleCardStateCloseButtonId","data-testid":"toggleCardStateCloseButtonId",iconProps:{iconName:q.a.CancelGlyph_20},ariaLabel:ExcelRibbonStrings.Close,customTooltip:ExcelRibbonStrings.Close,onClick:J,styles:W()}),a.createElement(z.a,{id:"toggleCardStateButtonId","data-testid":"toggleCardStateButtonId",iconProps:{iconName:S===Y.expanded?m.a.CommonControlChevronDown_16:m.a.CommonControlChevronUp_16},ariaLabel:S===Y.expanded?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand,customTooltip:S===Y.expanded?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand,onClick:function(e){S===Y.expanded?_(Y.collapsed):S===Y.collapsed&&_(Y.expanded),S!==Y.singleLine?null==f||f(S===Y.expanded):B()},styles:H()})),!ne&&a.createElement(z.a,{id:"toggleCardStateButtonId","data-testid":"toggleCardStateButtonId",iconProps:{iconName:m.a.CommonControlChevronDown_16},ariaLabel:$,customTooltip:$,onClick:function(e){var t=S!==Y.expanded;S===Y.expanded?_(Y.collapsed):_(Y.expanded),null==f||f(t)},styles:H()})),a.createElement("div",{ref:R,className:ne?D.collapseHeader:null},p())))),ne&&a.createElement("div",{ref:A,onPointerDown:X,style:{backgroundColor:"green"}},S===Y.singleLine&&a.createElement(z.a,{id:"toggleCardStateMinifiedButtonId","data-testid":"toggleCardStateMinifiedButtonId",iconProps:{iconName:m.a.FormulaBar_16},ariaLabel:ExcelRibbonStrings.FormulaArgumentAssistanceExpand,customTooltip:ExcelRibbonStrings.FormulaArgumentAssistanceExpand,onClick:J,styles:L()})),a.createElement("div",{className:D.expandedCard,ref:O,onPointerDown:X},a.createElement("div",{className:D.expandedCardPart,ref:k},g(S===Y.expanded)))))})),ae=n(2070),re=n(344),ie=n(1115),le={root:y},ce=Object(l.c)((function(e){return{display:"block",content:"attr(".concat(e,")"),fontSize:p.k.size12,fontWeight:p.l.semibold,height:0,overflow:"hidden",visibility:"hidden"}})),se={label:{root:{fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,paddingBottom:4,paddingTop:0}},formula:{root:{color:g.a.gray180,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,selectors:($={},$[p.m]={color:"WindowText"},$)}},text:{root:{color:g.a.gray180,fontSize:p.k.size12,lineHeight:p.k.size16,selectors:(ee={},ee[p.m]={color:"WindowText"},ee)}},param:{root:{color:Object(b.a)().shade20,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,selectors:(te={},te[p.m]={color:"Highlight"},te)}},parametersContainer:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:1,color:g.a.gray180,fontSize:p.k.size12,lineHeight:p.k.size16},expandedCardPart:{root:{paddingTop:4}}},ue=Object(l.c)((function(e){var t,n;return e?Object(p.db)({root:{selectors:(n={},n[p.m]={border:"2px solid Highlight"},n)}}):Object(p.db)({root:{cursor:"pointer",opacity:.5,selectors:(t={},t[p.m]={opacity:1},t)}})})),de=Object(l.c)((function(e){var t={":after":ce("formula-text")};return e?Object(p.db)({root:t}):Object(p.db)({root:Object(o.__assign)(Object(o.__assign)({},t),{textAlign:"unset",borderBottom:"0px","&:active, &:hover, &:active:hover, &:focus":{color:g.a.gray180}})})})),me={root:{direction:"ltr"}},pe=Object(l.c)((function(e){var t;return Object(p.db)({param:Object(o.__assign)({backgroundColor:ge(e),padding:"2px 5px 4px 5px",transition:"background-color 150ms linear",cursor:"default"},e?f.o:{}),paramName:{fontWeight:e?p.l.semibold:p.l.regular,":after":ce("param-name")}},{param:{selectors:(t={},t[p.m]={transition:"none",border:"1px solid WindowText"},t)}})})),ge=function(e){return e?"rgb(202, 234, 216, 0.6)":"rgb(245, 245, 245)"},fe=function(e){var t=e.description;return a.createElement(r.a,null,a.createElement(re.a,{styles:se.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceDescription)),a.createElement(ie.a,{styles:se.text},t))},be=function(e){var t=e.functionName,n=e.params,o=e.selected,r=e.functionNameStyle,i=e.textStyle,l=e.selectedStyle,c=e.listSeparator,s=e.styles,u=e.onClick;return a.createElement(ie.a,{styles:Object(p.db)(me,i,s),onClick:u},a.createElement(ie.a,{styles:r},t),a.createElement(a.Fragment,null,"(",n.length>0&&n.map((function(e,t){var n=t===o?l:i;return a.createElement(a.Fragment,{key:t},a.createElement(ie.a,{styles:n},e))})).reduce((function(e,t){return[e,"".concat(c," "),t]})),")"))},he=function(e){var t=e.functionName,n=e.parameters,o=e.listSeparator,i=e.description;return n?a.createElement(r.a,null,a.createElement(re.a,{styles:se.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExample)),a.createElement(be,{functionName:"=".concat(t),params:n.params,selected:n.activeParam,functionNameStyle:se.text,textStyle:se.text,selectedStyle:se.param,listSeparator:o}),i&&a.createElement(ie.a,{styles:se.text},i)):null},ve=function(e){var t=e.parameters,n=e.descriptions;return a.createElement(a.Fragment,null,t.params&&t.params.length>0&&a.createElement("div",{style:se.parametersContainer},t.params.map((function(e,o){var r=o===t.activeParam,i=pe(r);return a.createElement(a.Fragment,{key:o},a.createElement("div",{className:[i.param,i.paramName].join(" "),"param-name":e},e),a.createElement("div",{className:i.param},n[o]))}))))},xe=n(1287),Ee=function(e){var t=e.functionName,n=e.signatures,o=e.activeSignature,i=e.listSeparator,l=e.onFormulaClick;return a.createElement(r.a,{"data-testid":"functionSignatureId"},n.map((function(e,n){var r=n===o,c=e.signatureParams.params,s="".concat(t,"(").concat(c.join("".concat(i," ")),")");return r?a.createElement("div",{className:de(r).root,"formula-text":s,id:"aa_function_".concat(n),key:n},a.createElement(be,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:se.formula,textStyle:se.text,selectedStyle:se.param,listSeparator:i,styles:ue(r)})):a.createElement(xe.a,{styles:de(r),key:n,onClick:l(n),"formula-text":s,id:"aa_function_".concat(n),"data-testid":"functionLinkSignatureId"},a.createElement(be,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:se.formula,textStyle:se.text,selectedStyle:se.param,listSeparator:i,styles:ue(r)}))})))},Ce=function(e){var t=e.disabled,n=e.onClick,r=Object(o.__rest)(e,["disabled","onClick"]);return a.createElement(xe.a,{"data-testid":"feedbackId",disabled:t,styles:Object(p.db)(_,r.styles),onClick:n},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaAuthoringGiveFeedback))},ye=a.createContext({isFeedbackAllowed:!1}),Se=function(e){var t=e.functionName,n=e.isExpanded,o=e.onHelpClick,i=e.onFeedback,l=a.useContext(ye).isFeedbackAllowed;return a.createElement(r.a,{horizontal:!0,horizontalAlign:"space-between"},a.createElement(xe.a,{"data-testid":"learnMoreLinkId",disabled:!n,styles:_,onClick:o},"".concat(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceLearnMore)," ").concat(t)),l&&a.createElement(Ce,{disabled:!n,onClick:i}))},_e=a.forwardRef((function(e,t){var n=e.setComponentApi,o=e.onLayoutChange,l=e.getTargetAndBounds,u=e.functionRenderingInfo,d=e.callbacks,m=e.isExpanded,p=e.hidden,g=u,f=g.functionName,b=g.functionDescription,h=g.signatures,v=g.activeSignature,x=g.listSeparator,E=a.useState(null!=v?v:0),C=E[0],y=E[1],S=h[C],_=function(e){return function(t){y(e)}},P=function(e){var t;null===(t=null==d?void 0:d.onHelpLink)||void 0===t||t.call(d)},R=function(e){var t;null===(t=null==d?void 0:d.onFeedback)||void 0===t||t.call(d,u)};return a.createElement(ae.a,null,a.createElement(oe,{getTargetAndBounds:l,setComponentApi:n,onLayoutChange:o,renderCompactCard:function(){return a.createElement(Ee,{functionName:f,signatures:h,activeSignature:C,listSeparator:x,onFormulaClick:_})},renderExpandedCard:function(e){return a.createElement(r.a,{styles:se.expandedCardPart,tokens:{childrenGap:12}},a.createElement(fe,{description:b}),a.createElement(he,{functionName:f,parameters:S.exampleParams,listSeparator:x,description:S.exampleDescription}),a.createElement(ve,{parameters:S.descriptionParams,descriptions:S.descriptions}),a.createElement(Se,{functionName:f,isExpanded:e,onHelpClick:P,onFeedback:R}))},isExpanded:m,onIsExpandedChange:null==d?void 0:d.onIsExpandedChange,onDismiss:function(e){var t,n;Pe()&&(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===i.a.escape&&(null===(n=null==d?void 0:d.onDismissClick)||void 0===n||n.call(d))},ref:t,key:m.toString(),styles:le,hidden:p,id:c,collapsedId:s,layerProps:{eventBubblingEnabled:!0}}))})),Pe=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:8745608_FormulaAssistanceDismiss")})),Re=n(745),Oe=Object(o.__assign)(Object(o.__assign)({},j),{cursor:"default"}),ke=Object(l.c)((function(){return Object(p.db)(S,le)})),Ae=a.forwardRef((function(e,t){var n=e.setComponentApi,o=e.onLayoutChange,r=e.getTargetAndBounds,i=e.functionRenderingInfo,l=e.hidden,u=i,d=u.functionName,m=u.listSeparator,p=u.parameters,g=U(c),f=ke(),b=a.useCallback((function(){if(!l&&g){var e=r(),t=e.target,n=e.bounds,a=e.isFloating,i=e.renderDown,c=g.clientHeight,s=g.clientWidth,u=Q(t,c,a?c:Math.max(c,x),s,a,i,n);o(u);for(var d=Z(u),m=0,p=Object.entries(d);m<p.length;m++){var f=p[m],b=f[0],h=f[1];g.style.setProperty(b,h)}}}),[r,l,o,g]);return a.useEffect((function(){n({updatePosition:b})}),[n,b]),a.useEffect((function(){g&&b()})),a.createElement(Re.a,{isBeakVisible:!1,styles:f,hidden:l,id:c},a.createElement("div",{ref:t,id:s,style:Oe},a.createElement(be,{functionName:d,params:p.params,selected:p.activeParam,functionNameStyle:se.formula,textStyle:se.text,selectedStyle:se.param,listSeparator:m,styles:ue(!0)})))})),we=a.forwardRef((function(e,t){switch(e.kind){case"Full":return a.createElement(_e,Object(o.__assign)({},e,{ref:t}));case"Minimal":return a.createElement(Ae,Object(o.__assign)({},e,{ref:t}))}})),Fe="ac-callout",je=n(507),Te=n(703),Ie=n(316),Me=n(1176),Ne=n(793),De=n(897),Be=n(1351),He=n(125),We=n(21),Le=n(209),ze=He.b.getInstance().getTheme(),Ge=Object(p.X)(0,p.t),Ke=12,Ve=2,Ue=4,Je=8,Ze=4,Qe=4,Ye=6,Xe=16,qe=1,$e=4,et=28,tt=2,nt="center",ot=4,at=2,rt=16,it=8,lt=4,ct=340,st=240,ut=4,dt=6,mt=4,pt=8,gt=ct-2*ot-rt-it-lt-ut-pt-3*mt,ft=ct-2*Ke-rt-2*lt-dt-pt-2*mt,bt=ct-2*ot-rt-it-lt-ut,ht=ct-2*Ke-rt-2*lt-dt,vt={height:"100%",display:"flex",flexDirection:"column",width:"inherit"},xt={display:"flex",minHeight:"0px",flexDirection:"column"},Et={root:y},Ct="svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m'])",yt=Object(l.c)((function(){var e,t;return Object(p.eb)({"&:hover":(e={},e[p.m]=(t={},t[Ct]={fill:"HighlightText"},t),e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),St=Object(l.c)((function(e,t){var n,a,r=kt(),i=At();return Object(p.db)(Object(Be.b)(ze),{linkContent:Object(o.__assign)({color:i?We.a.colorNeutralForeground1:g.a.gray180,minHeight:et,padding:r?void 0:"0px ".concat(Ke,"px 0px ").concat(Ke,"px"),cursor:"pointer",userSelect:"none",backgroundColor:e?i?We.a.colorNeutralBackground1Hover:"#F5F5F5":"",borderRadius:r?Ze:void 0,"&:hover":Object(o.__assign)({backgroundColor:i?We.a.colorNeutralBackground1Selected:"#F0F0F0"},f.o)},e?f.o:{}),icon:{alignSelf:nt,width:rt,height:rt,margin:r?"0px ".concat(lt,"px 0px ").concat(it,"px"):"0px ".concat(lt,"px"),selectors:(n={},n[Ge]={fontSize:"",width:""},n[p.m]={selectors:(a={},a[Ct]={fill:e?"HighlightText":""},a)},n)},label:{font:"12px Segoe UI",lineHeight:p.k.size16,flexGrow:"",overflow:t?"hidden":"",textOverflow:t?"elipsis":"",alignSelf:nt,margin:"0px 0px 0px ".concat(r?ut:dt,"px"),display:t?"-webkit-box":void 0,whiteSpace:t?"normal":void 0,wordBreak:t?"break-all":void 0,WebkitLineClamp:t?"1":void 0,WebkitBoxOrient:t?"vertical":void 0},secondaryText:Object(o.__assign)({color:i?We.a.colorNeutralForeground2:g.a.gray130,fontSize:p.k.size10,lineHeight:p.k.size12,textAlign:"left",whiteSpace:"normal",padding:"2px 0px 2px 8px",alignSelf:nt,overflow:t?"hidden":void 0,overflowWrap:t?"break-word":void 0},Ot(e))})})),_t=Object(l.c)((function(e,t,n,a,r){var i,l,c,s=kt(),u=t?s?qe+Ye+Qe:qe+2*$e:0,d=s?Ve+Je*(tt+et)+u:Ue+Je*et+u,m=s?d-(Ve+n*(tt+et)+u):d-(Ue+n*et+u);return Object(p.db)(R,{root:{width:e?void 0:ct,minWidth:e?st:void 0,maxWidth:e?ct:void 0,paddingTop:s?Ve:Ue,borderRadius:s?Ze:void 0},subComponentStyles:{menuItem:{item:{selectors:(i={},i[" [role='menuitem']"]={margin:s?"".concat(at,"px ").concat(ot,"px 0px ").concat(ot,"px"):void 0},i)},divider:{height:qe,margin:s?"".concat(Ye,"px ").concat(Xe,"px ").concat(Qe,"px ").concat(Xe,"px"):$e,borderRadius:s?"0.5px":void 0,selectors:(l={},l[p.m]={backgroundColor:"WindowText"},l)}}},simpleSection:Object(o.__assign)(Object(o.__assign)({maxHeight:m,overflowY:"auto",overflowX:r?"hidden":void 0},P),{selectors:Object(o.__assign)((c={},c[" [role='menuitem']"]={marginRight:s&&m<a*(tt+et)?"0px !important":void 0},c),P.selectors)})})})),Pt=Object(l.c)((function(){var e=kt();return{footer:{root:{padding:e?"".concat(at,"px ").concat(ot,"px ").concat(ot,"px ").concat(ot,"px"):"".concat(ot,"px ").concat(Ke,"px 8px ").concat(Ke,"px")}},feedback:{root:{float:"right",fontSize:p.k.size10,lineHeight:p.k.size14,margin:e?"".concat(at,"px 12px ").concat(at,"px 0px"):void 0}}}})),Rt=function(e){switch(e.kind){case Le.CompletionItemKind.Function:return e.type===Le.SuggestionKind.Simple?m.a.FormulaBar_16:m.a.Intelligence_16;case Le.CompletionItemKind.Enum:return m.a.NameManager_16;case Le.CompletionItemKind.RichEntity:return m.a.Tag_16;case Le.CompletionItemKind.LetVariable:return m.a.FormulaLet_16;case Le.CompletionItemKind.NamedRange:return m.a.NameRange_16;case Le.CompletionItemKind.Table:return m.a.Table_16;case Le.CompletionItemKind.TableHeader:return m.a.SelectColumn_16;case Le.CompletionItemKind.RichEntityEmptyCellRef:return m.a.AbsoluteReference_16;case Le.CompletionItemKind.Lambda:return m.a.FormulaBar_16;case Le.CompletionItemKind.NamedOther:return m.a.Tag_16;default:return""}},Ot=function(e){var t;return{selectors:(t={},t[p.m]={color:e?"HighlightText":"WindowText"},t)}},kt=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),At=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:8137695_isFluentvNextColorChangesEnabled")})),wt=function(e){var t=e.onFeedback,n=a.useContext(ye).isFeedbackAllowed;return a.createElement(r.a,{styles:Pt().footer,tokens:{childrenGap:8}},n&&a.createElement("div",null,a.createElement(Ce,{styles:Pt().feedback,disabled:!1,onClick:t})))},Ft=n(1134);function jt(e,t,n,o){if(!t)return 0;var a=Tt(t,o);if(!e)return Math.min(a,n);var r=Tt(e,o);if(a+r>=n){G.a.sendTraceTag(508303310,K.a.msoulscat_ES_EWAJS,V.a.Info,"sharedUtils.atLeastThirdOfAvailableWidth: The needed width is bigger than the available limit,\n      targetWidth: ".concat(a,", additionalTextWidth:  ").concat(r,"."));var i=n/3;if(a>i){a=i;var l=2*i-r;l>0&&(a+=l)}}return a}var Tt=function(e,t){void 0===t&&(t="12px Segoe UI");var n=document.createElement("canvas").getContext("2d");return n.font=t,n.measureText(e).width};function It(e){return null!=e}function Mt(e){return null==e}var Nt,Dt,Bt=a.forwardRef((function(e,t){var n,r=e.setComponentApi,l=e.onLayoutChange,c=e.getTargetAndBounds,s=e.completionItems,u=e.callbacks,d=e.activeItemIndex,m=e.hidden,f=e.disableItemReadout,b=a.useRef(null);a.useLayoutEffect((function(){b.current&&b.current.scrollIntoView({block:"nearest"})}));var h=a.useMemo((function(){return Object(De.a)(s)}),[s]),v=a.useMemo((function(){return h.reduce((function(e,t){return e[t.type]=!0,e}),{})}),[h]),E=v[Le.SuggestionKind.Smart],C=E&&!v[Le.SuggestionKind.Simple],y=E&&v[Le.SuggestionKind.Simple],S=_t(C,y,h.filter((function(e){return e.type===Le.SuggestionKind.Smart})).length,h.filter((function(e){return e.type===Le.SuggestionKind.Simple})).length,zt()),_=function(e){return function(t){var n;e!==d&&(null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e)),t.target.offsetHeight<t.target.scrollHeight&&t.target.setAttribute("title",h[e].label)}},P=function(e){return function(t){var n;t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e])}},R=function(e){return function(t){var n;t.nativeEvent.keyCode===i.a.enter&&(t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e]))}},O=function(e){return function(t){var n,o;e!==d&&(t.stopPropagation(),null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e),null===(o=t.currentTarget)||void 0===o||o.focus())}},k=a.useCallback((function(e,n){var r=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"smart-section"===e.key}))}),i=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"simple-section"===e.key}))}),l={style:vt},c={style:xt};return a.createElement(Ft.a,null,a.createElement("div",Object(o.__assign)({},l,{ref:t}),a.createElement(Te.a,Object(o.__assign)({disabled:m},c),n(r),a.createElement("div",{className:S.simpleSection},n(i))),a.createElement(wt,{onFeedback:function(e){var t;null===(t=null==u?void 0:u.onFeedback)||void 0===t||t.call(u)}})))}),[u,S.simpleSection,t,m]),A=a.useCallback((function(e,t){return function(n,o){var r,i=Wt(n.item.text,t),l=Lt(e,n.item.text,t);return a.createElement(a.Fragment,null,o.renderItemIcon(n),a.createElement("span",{id:e?"ac_selected_function":void 0,className:n.classNames.label,style:zt()?(r=l,{width:r,minWidth:r}):void 0},n.item.text),t&&w(t,i),e&&o.renderSecondaryText(n))}}),[]),w=function(e,t){return a.createElement(a.Fragment,null,a.createElement("span",{style:{margin:kt()?"2px ".concat(mt,"px"):"2px 0px 2px ".concat(mt,"px"),width:pt,color:At()?We.a.colorNeutralForeground2:g.a.gray130,fontSize:p.k.size12}},"="),a.createElement("span",{style:(n=t,{display:"-webkit-box",whiteSpace:"normal",wordBreak:"break-all",width:n,minWidth:n,margin:kt()?"2px ".concat(mt,"px 2px 0px"):"2px 0px 2px ".concat(mt,"px"),color:At()?We.a.colorNeutralForeground2:g.a.gray130,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"elipsis",overflow:"hidden",font:"12px Segoe UI"})},e));var n},F=h.map((function(e,t){var n,o;return{key:e.label+e.kind,text:e.label,secondaryText:e.detail,iconProps:{iconName:Rt(e)},onRender:(o=t,function(e,t){var n=o===d,r=h[o].type===Le.SuggestionKind.Smart,i=n&&!C;return a.createElement("div",{role:"menuitem",className:yt(),"data-testid":"menuItemId".concat(o),onMouseMove:_(o),onMouseDown:P(o),onKeyDown:R(o),onFocus:O(o),ref:n?b:void 0,"data-is-focusable":!0,tabIndex:n?0:-1,"aria-label":f?" ":void 0},a.createElement(je.a,{classNames:St(i,!!zt()||r),hasIcons:!0,index:o,item:e}))}),onRenderContent:A(e.type===Le.SuggestionKind.Simple&&t===d||Kt()&&e.kind===Le.CompletionItemKind.Enum,null!==(n=e.evaluation)&&void 0!==n?n:void 0),data:e.type}})),j={key:"smart-section",itemType:Ie.a.Section,sectionProps:{items:F.filter((function(e){return e.data===Le.SuggestionKind.Smart})),bottomDivider:y}},T={key:"simple-section",itemType:Ie.a.Section,sectionProps:{items:F.filter((function(e){return e.data===Le.SuggestionKind.Simple})),bottomDivider:!1}},I=null!==(n=null==u?void 0:u.onRestoreFocus)&&void 0!==n?n:void 0,M=[j,T],N=U(Fe),D=a.useCallback((function(){if(!m&&N){var e=c(),t=e.target,n=e.bounds,o=e.isFloating,a=e.renderDown,r=N.clientHeight,i=N.clientWidth,s=Q(t,r,o||C?r:Math.max(r,x),i,o,a||C,n);l(s);for(var u=Z(s),d=0,p=Object.entries(u);d<p.length;d++){var g=p[d],f=g[0],b=g[1];N.style.setProperty(f,b)}}}),[c,m,l,C,N]);return a.useEffect((function(){r({updatePosition:D})}),[r,D]),a.useEffect((function(){N&&D()})),a.createElement(Me.a,{items:M,styles:S,onRenderMenuList:k,isBeakVisible:!1,shouldFocusOnMount:!1,hidden:m,calloutProps:{id:Fe,styles:Et,layerProps:{eventBubblingEnabled:!0}},focusZoneAs:Ht,focusZoneProps:{disabled:m},onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===i.a.escape&&(null===(n=null==u?void 0:u.onDismiss)||void 0===n||n.call(u))},onRestoreFocus:I})})),Ht=function(e){return a.createElement(Ne.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)},Wt=function(e,t){if(void 0!==e&&void 0!==t)return jt(e,t,Gt()?gt:ft)},Lt=function(e,t,n){if(void 0!==t&&void 0===n){var o=Gt()?bt:ht;if(!e)return o;var a=Tt(t);return a<=2/3*o?a:2/3*o}},zt=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:7921247_fixAutoCompleteOverFlowBug")})),Gt=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),Kt=Object(l.c)((function(){return Object(T.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")})),Vt="formulaRepair-callout",Ut=n(2517),Jt=n(89),Zt=He.b.getInstance().getTheme(),Qt=Zt.palette,Yt={root:{margin:"0 8px",padding:0,height:5,":before":{backgroundColor:Qt.neutralQuaternaryAlt}}},Xt=Object(l.c)((function(){var e;return Object(p.eb)({"&:hover":(e={},e[p.m]={},e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),qt=Object(l.c)((function(){return Object(p.db)(Object(Be.b)(Zt),{linkContent:{color:Qt.neutralDark,minHeight:24,cursor:"pointer",userSelect:"none","&:hover":Object(o.__assign)({},f.o)}})})),$t=Object(l.c)((function(e){return Object(p.eb)({justifyContent:"space-between",display:"flex",width:"100%",padding:"2px 5px",margin:"0px 4px",borderRadius:4,backgroundColor:e?Qt.neutralLighterAlt:Qt.white,"&:hover":{backgroundColor:Qt.neutralLighter}})})),en=Object(l.c)((function(){return Object(p.db)(R,{root:{maxWidth:340,minWidth:240},list:Object(o.__assign)({maxHeight:72,overflowY:"auto"},P)})})),tn={root:{root:{padding:"8px ".concat(12,"px 3px ").concat(12,"px")}},title:{root:{fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size12,color:Qt.neutralDark,padding:0}},description:{root:{color:Qt.neutralSecondary,fontSize:p.k.size12,lineHeight:p.k.size16,fontWeight:p.l.regular,selectors:(Nt={},Nt[p.m]={color:"WindowText"},Nt)}}},nn={root:{padding:"0px ".concat(12,"px 5px ").concat(12,"px")}},on=Object(l.c)((function(){return Object(p.eb)({fontSize:p.k.size12,borderBottom:"1px solid transparent",padding:"0px 3px",height:"24px",":hover":{backgroundColor:Qt.neutralLighterAlt,color:Qt.black,border:"1px solid "+Qt.neutralLighter}})})),an={root:{width:12,marginLeft:0}},rn={root:{backgroundColor:"rgb(210, 224, 244)",borderRadius:"2px"}},ln={root:{font:"12px consolas"}},cn={lineHeight:p.k.size16,flexGrow:"",alignSelf:"center",padding:"".concat(2,"px 0px"),margin:"0px 0px 0px 0px",overflow:"hidden",textOverflow:"ellipsis","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",display:"-webkit-box","white-space":"normal","word-break":"break-all",flex:1},sn=Object(l.c)((function(e){return e===Le.RepairItemPartType.None?ln:Object(p.db)(ln,rn)})),un={padding:"0px",paddingLeft:"".concat(5,"px"),overflow:"hidden",textOverflow:"ellipsis",font:"12px consolas",alignSelf:"center"},dn=n(644),mn=function(e){var t=e.onIgnore,n=e.onFeedback,o=e.onApply,i=a.useContext(ye).isFeedbackAllowed;return a.createElement(r.a,{styles:nn,horizontal:!0,horizontalAlign:"space-between"},a.createElement(r.a,{horizontal:!0,horizontalAlign:"start"},It(o)&&a.createElement(dn.a,{className:on(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Apply),onClick:o,iconProps:{iconName:m.a.Checkmark_16,styles:an}}),a.createElement(dn.a,{className:on(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaAuthoringIgnore),onClick:t,iconProps:{iconName:m.a.DeleteHover_16,styles:an}})),i&&a.createElement(Ce,{disabled:!1,onClick:n}))},pn=function(e,t){return a.createElement(r.a,{styles:tn.root,tokens:{childrenGap:2}},a.createElement(ie.a,{styles:tn.title},e),a.createElement(ie.a,{styles:tn.description},t))},gn=function(e){var t=e.title,n=e.description,o=e.repairs,a=null!=t?t:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultTitle),r=null!=n?n:1===o?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultDescriptionSingle):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultDescriptionMultiple).replace("{0}",o.toString());return pn(a,r)},fn=function(e){var t=e.item,n=e.repairParts,r=e.isChecked,i=Object(a.useMemo)((function(){return jt(t.text,t.secondaryText,311,"12px consolas")}),[t.text,t.secondaryText]),l=Object(o.__assign)(Object(o.__assign)({},un),{width:"".concat(i,"px")}),c=n.filter(It);return a.createElement("div",{className:$t(r)},a.createElement("div",{style:cn},c.map((function(e){var n,o;return a.createElement(ie.a,{key:e.location.start,styles:sn(e.type),style:{color:null!==(n=e.color)&&void 0!==n?n:void 0}},null===(o=t.text)||void 0===o?void 0:o.substring(e.location.start,e.location.end))}))),t.secondaryText&&a.createElement(ie.a,{style:l},t.secondaryText))},bn=function(e){var t=e.diagnostics,n=e.description,i=e.repairs,l=e.callbacks,c=Object(o.__rest)(e,["diagnostics","description","repairs","callbacks"]),s=en(),u=a.useMemo((function(){return Object(De.a)(i)}),[i]),d=u.length>1,m=function(e,t){var n=Object(a.useState)(0),o=n[0],r=n[1],i=Object(a.useState)(),l=i[0],c=i[1],s=Object(a.useRef)([]).current,u=Object(a.useCallback)((function(n,o){var a,r;Mt(s[n])&&(s[n]=null==t?void 0:t(e[n])),null===(a=s[n])||void 0===a||a.highlightRanges(o),c(null===(r=s[n])||void 0===r?void 0:r.coloredParts)}),[t,s,e]);Object(a.useEffect)((function(){return u(0,!0),function(){return u(0,!1)}}),[u]);return[o,function(e){e!==o&&(u(o,!1),u(e,!0),r(e))},l]}(u,null==l?void 0:l.getItemHighlights),p=m[0],g=m[1],f=m[2],b=function(e){return function(t){var n;"Enter"===t.nativeEvent.key&&(t.preventDefault(),null===(n=null==l?void 0:l.onCommit)||void 0===n||n.call(l,e))}},h=function(e,t){return function(n,o){var r,i=function(){return g(t)};return a.createElement("div",{role:"menuitem",className:Xt(),"data-is-focusable":!0,onPointerDown:(r=e,function(e){var t;e.preventDefault(),null===(t=null==l?void 0:l.onCommit)||void 0===t||t.call(l,r)}),onKeyDown:b(e),onMouseEnter:i,onFocus:i},a.createElement(je.a,{classNames:qt(),hasIcons:!1,index:t,item:n}))}},v=function(e){return a.createElement(fn,Object(o.__assign)({},e,{isChecked:d&&p===e.index,repairParts:p===e.index&&It(f)?f:u[e.index].repairedFormulaParts}))},x=a.useCallback((function(){var e,t=u[d?p:0];t?null===(e=null==l?void 0:l.onCommit)||void 0===e||e.call(l,t):G.a.sendTraceTag(508179275,K.a.msoulscat_ES_EWAJS,V.a.Error,"FormulaRepairCard: onApply: repair is undefined")}),[l,u,p,d]),E=a.useCallback((function(e,i){var c=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items});return a.createElement("div",{ref:null==l?void 0:l.onRender},a.createElement(r.a,{tokens:{childrenGap:4}},a.createElement(gn,{title:t,description:n,repairs:u.length}),i(c),a.createElement(Ut.a,{styles:Yt}),a.createElement(mn,{onFeedback:function(e){var t;null===(t=null==l?void 0:l.onFeedback)||void 0===t||t.call(l)},onIgnore:function(e){var t;null===(t=null==l?void 0:l.onIgnore)||void 0===t||t.call(l)},onApply:x})))}),[n,t,u,l,x]),C=u.map((function(e,t){return{key:e.text,text:e.text,secondaryText:vn(e.formulaValue)?void 0:" = ".concat(e.formulaValue),onRender:h(e,t),onRenderContent:v}}));return a.createElement(Me.a,{items:C,styles:s,onRenderMenuList:E,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{id:Vt,styles:S,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()}},gapSpace:4,onDismiss:function(){var e;null===(e=null==l?void 0:l.onDismiss)||void 0===e||e.call(l)},target:c.target,directionalHint:"below"===c.renderLocation?Jt.a.bottomLeftEdge:Jt.a.rightTopEdge,onRestoreFocus:hn})},hn=function(){},vn=function(e){return null==e||0===e.length},xn=n(108),En=n(54),Cn=n(1413),yn=n(1167),Sn=n(228),_n=n(2109),Pn=n(394),Rn={root:{direction:"ltr"},subText:{overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis",fontFamily:'Consolas, "Courier New", monospace'}},On=a.memo((function(e){var t,n=e.isLoaded,r=e.value,i=e.textColor,l=Object(o.__rest)(e,["isLoaded","value","textColor"]);return n?(t=r||void 0,It(i)&&(t=a.createElement("span",{style:{color:i}},t))):t=a.createElement(_n.a,{type:"AppSpinnerProps",id:"ValuePreviewSpinner",appColors:Object(b.a)(),spinnerSize:Pn.a.small}),a.createElement(Sn.a,null,(function(e){return a.createElement(yn.a,Object(o.__assign)({},l,{calloutProps:{styles:Object(Cn.a)(e),beakWidth:10},content:t,styles:Rn,directionalHint:Jt.a.topCenter}))}))})),kn=function(){return pn(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultTitle),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaSyntaxErrorIndicationDescription))},An=function(e){var t=Object(o.__rest)(e,[]);return a.createElement(u.a,{isBeakVisible:!1,id:Vt,styles:S,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()},onDismiss:function(){var e;null===(e=null==t?void 0:t.onDismiss)||void 0===e||e.call(t)},target:t.target,gapSpace:4,directionalHint:Jt.a.rightTopEdge,focusTrapProps:{isClickableOutsideFocusTrap:!0,disableFirstFocus:!0,forceFocusInsideTrap:!1}},a.createElement("div",{ref:null==t?void 0:t.onRender},a.createElement(r.a,{tokens:{childrenGap:8}},a.createElement(kn,null),a.createElement(mn,{onFeedback:function(e){var n;null===(n=null==t?void 0:t.onFeedback)||void 0===n||n.call(t)},onIgnore:function(e){var n;null===(n=null==t?void 0:t.onIgnore)||void 0===n||n.call(t)}}))))},wn=n(2525),Fn=He.b.getInstance().getTheme(),jn=Object(l.c)((function(){return Object(p.eb)({backgroundColor:Fn.palette.white,border:"1px solid",borderColor:Fn.palette.neutralQuaternary,borderRadius:"2px",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.1)",height:"28px",width:"28px"})})),Tn={root:{width:"100%",height:"100%"}},In=function(e){var t=e.onClick,n=e.target;return a.createElement(ae.a,null,a.createElement(wn.a,{target:n,directionalHint:Jt.a.rightCenter,offsetFromTarget:5,className:jn()},a.createElement(z.a,{onClick:t,id:"formula-repair-icon",customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairAvailable),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairAvailable),tooltipDirection:Jt.a.topCenter,iconProps:{iconName:m.a.SearchTools_16},styles:Tn})))};!function(e){e[e.ArgumentAssistanceCard=0]="ArgumentAssistanceCard",e[e.AutoCompleteMenu=1]="AutoCompleteMenu",e[e.ValuePreview=2]="ValuePreview"}(Dt||(Dt={}));var Mn=function(){function e(e){this.context={isFeedbackAllowed:!1},this.componentApis={},this.componentRefs={},this.lastGetTargetAndBounds=null,this.lastProps=new Map,this.position={x:0,y:0,renderDown:!0},this.useFixedPosition=!1,e&&(this.context=Object(o.__assign)(Object(o.__assign)({},this.context),e))}return e.prototype.onLayoutChange=function(e){var t=e.x,n=e.y,o=e.renderDown;this.position.x=t,this.position.y=n,this.position.renderDown=o},e.prototype.getTargetAndBounds=function(e){if(void 0===e&&(e=!1),this.useFixedPosition&&!e){var t=this.position,n=t.x,o=t.y,a=t.renderDown;return{target:{top:o,left:n,right:n,bottom:o},bounds:{top:0,left:0,right:innerWidth,bottom:innerHeight},isFloating:!0,renderDown:a}}Mt(this.lastGetTargetAndBounds)&&G.a.sendTraceTag(512313119,K.a.msoulscat_ES_EWAJS,V.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds is ".concat(this.lastGetTargetAndBounds,"."));var r=this.lastGetTargetAndBounds();if(Mt(r)||Mt(r.target)||Mt(r.bounds)){var i=JSON.stringify(r);G.a.sendTraceTag(512313118,K.a.msoulscat_ES_EWAJS,V.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds() returned: ".concat(i,"."))}return{target:r.target,bounds:r.bounds,isFloating:!1,renderDown:this.position.renderDown,activeCellAndGridZoom:r.activeCellAndGridZoom}},e.prototype.renderControl=function(e,t,n,r){var i=this;if(t&&n){this.lastGetTargetAndBounds=r,this.componentRefs[e]||(this.componentRefs[e]=a.createRef());var l,c={type:e,rendered:!0,ref:this.componentRefs[e],getTargetAndBounds:this.getTargetAndBounds.bind(this),onLayoutChange:this.onLayoutChange.bind(this),setComponentApi:function(t){i.componentApis[e]=t}};switch(e){case Dt.ArgumentAssistanceCard:var s=n;l=a.createElement(we,Object(o.__assign)({},c,s));break;case Dt.AutoCompleteMenu:l=a.createElement(Bt,Object(o.__assign)({},c,n,{disableItemReadout:!0}))}G.a.shipAssertTag(520926812,K.a.msoulscat_ES_EWAJS,It(l),"FormulaAssistanceUIControl.renderControl: "+"control is ".concat(l," because the type '").concat(e,"' is unknown.")),En.render(a.createElement(ye.Provider,{value:this.context},l),t),this.lastProps.set(t,Object(o.__assign)(Object(o.__assign)({},c),n))}},e.prototype.renderArgumentAssistanceCard=function(e,t,n){this.renderControl(Dt.ArgumentAssistanceCard,e,t,n)},e.prototype.renderAutoCompleteMenu=function(e,t,n){this.renderControl(Dt.AutoCompleteMenu,e,t,n)},e.prototype.renderValuePreview=function(e,t,n){e&&t&&n&&En.render(a.createElement(On,Object(o.__assign)({},n,{targetElement:t})),e)},e.prototype.renderFormulaRepair=function(e,t,n){e&&t&&n&&En.render(a.createElement(ye.Provider,{value:this.context},a.createElement(bn,Object(o.__assign)({},n,{target:t}))),e)},e.prototype.renderFormulaRepairIcon=function(e,t,n){e&&t&&n&&En.render(a.createElement(ye.Provider,{value:this.context},a.createElement(In,{onClick:n,target:t})),e)},e.prototype.renderSyntaxErrorIndication=function(e,t,n){e&&t&&n&&En.render(a.createElement(ye.Provider,{value:this.context},a.createElement(An,Object(o.__assign)({},n,{target:t}))),e)},e.prototype.dismiss=function(e){if(e)if(this.lastProps.has(e)){var t=this.lastProps.get(e);if(t&&t.rendered){t.rendered=!1;var n=null;switch(t.type){case Dt.AutoCompleteMenu:n=a.createElement(Bt,Object(o.__assign)({},t,{hidden:!0}));break;case Dt.ArgumentAssistanceCard:n=a.createElement(we,Object(o.__assign)({},t,{hidden:!0}))}n&&En.render(a.createElement(ye.Provider,{value:this.context},n),e)}}else En.unmountComponentAtNode(e)},e.prototype.focus=function(e){var t=this.getRootElement(e);return this.focusElement(t)},e.prototype.focusElement=function(e){return!!e&&Object(xn.c)(e)},e.prototype.getRootElement=function(e){var t;return(null===(t=this.componentRefs[e])||void 0===t?void 0:t.current)||null},e.prototype.getCalloutElement=function(e){switch(e){case Dt.ArgumentAssistanceCard:return document.getElementById(c);default:return null}},e.prototype.getDraggableElement=function(e){switch(e){case Dt.ArgumentAssistanceCard:return document.getElementById(s);default:return null}},e.prototype.updatePosition=function(e){var t;null===(t=this.componentApis[e])||void 0===t||t.updatePosition()},e.prototype.updateContext=function(e){this.context=Object(o.__assign)(Object(o.__assign)({},this.context),e)},e.prototype.getPosition=function(){return this.position},e.prototype.setFixedPosition=function(e){this.useFixedPosition=It(e),e&&(this.position.x=e.x,this.position.y=e.y,this.position.renderDown=e.renderDown)},e}(),Nn=n(661),Dn=new(function(){function e(){}return e.prototype.create=function(e){return Nn.a.registerUiSlice20Icons(),new Mn(e)},e}())},209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3);o.__exportStar(n(2e3),t),o.__exportStar(n(2001),t),o.__exportStar(n(2002),t),o.__exportStar(n(2003),t),o.__exportStar(n(2004),t),o.__exportStar(n(2005),t),o.__exportStar(n(2006),t),o.__exportStar(n(2007),t),o.__exportStar(n(2008),t),o.__exportStar(n(2009),t),o.__exportStar(n(2010),t),o.__exportStar(n(2011),t)}},[[2029,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/formulaAssistance.min.js.map/d5453e19ca63ef873b5d17443e4eff5b/formulaAssistance.min.js.map